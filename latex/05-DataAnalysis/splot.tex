%!TEX root = ../main.tex

\subsection{Unfolding data distributions using sWeights}
\label{sec:dataanalysis:selection:splot}

Another approach to unfold data distributions is to statistically remove
background contributions by applying weights. To do so, the shape of the
signal and background contributions for one or several dimensions is needed.
While the shapes of signal decays are mostly defined by some theoretical
considerations, which eventually need to be modified to account for
experimental effects, like resolutions or acceptances, it is usually difficult
to motivate the shape for background contributions from first principles. An
observable that has proven to provide a good separation is the invariant mass.
Reliable parametrisations of the invariant mass distribution of signal and
background contributions can be found quite easily. In the \sPlot
technique~\cite{Pivk:2004ty} the weights are calculated from yields of an
extended maximum likelihood fit (see
\cref{sec:dataanalysis:maximumlikelihood}). Based on the fit results sWeights
according to
\begin{align}
	\SPlotweight(x_i) = \frac{\sum_{j = 1}^{N_s}\matr{V}_{\text{n}j}f_j(x_i)}{\sum_{k = 1}^{N_s} N_k f_k(x_i)}
\label{eq:dataanalysis:selection:splot:weightdefinition}
\end{align}
can be calculated for each candidate. Herein, the indices $j$ and $k$ sum over
the $N_s$ categories described in the PDF $f$. The matrix \matr{V} contains
the covariances between the yields $N$ and needs to be determined from an
individual fit in which all other floating parameters are fixed. The sWeights
fulfil the condition that their sum over one category returns the
corresponding fitted yield. The sWeights can be applied to other observables
if they are uncorrelated with the one used to obtain the sWeights. In
sweighted histograms the uncertainty on the bin content of bin $i$ is given by
\begin{align}
	\sigma(i) = \sqrt{\sum_{e \subset i} (\SPlotweight)^2}\,.
\label{eq:dataanalysis:selection:splot:weighterror}
\end{align}